{
  "name": "My workflow 6 copy",
  "nodes": [
    {
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "mode": "custom",
              "cronExpression": "0 6 * * *"
            }
          ]
        }
      },
      "name": "Cron",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [
        -7360,
        -15860
      ],
      "id": "8d5973dc-4d00-4345-87b1-a3aceb1af626"
    },
    {
      "parameters": {
        "requestMethod": "POST",
        "url": "https://api.openai.com/v1/chat/completions",
        "jsonParameters": true,
        "options": {},
        "bodyParametersJson": "{\n  \"model\": \"gpt-3.5-turbo\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"\u0422\u044b \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043c\u0430\u0440\u043a\u0435\u0442\u043e\u043b\u043e\u0433 \u0438 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0441\u0442 Instagram Reels. \u0422\u0432\u043e\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u2014 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0432\u0438\u0440\u0443\u0441\u043d\u044b\u0435 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0438 \u0438 \u043b\u0430\u043a\u043e\u043d\u0438\u0447\u043d\u044b\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0440\u0430\u0437\u0443 \u0446\u0435\u043f\u043b\u044f\u044e\u0442 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u0438 \u0434\u043e\u043d\u043e\u0441\u044f\u0442 \u0441\u0443\u0442\u044c.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"\u0421\u043e\u0437\u0434\u0430\u0439 **\u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a** \u0438 **\u043a\u0440\u0430\u0442\u043a\u043e\u0435, \u0446\u0435\u043f\u043b\u044f\u044e\u0449\u0435\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435** \u0434\u043b\u044f Instagram Reels \u043d\u0430 \u0442\u0435\u043c\u0443: [\u0423\u041a\u0410\u0416\u0418 \u0422\u0415\u041c\u0423 \u0417\u0414\u0415\u0421\u042c].\\n\\n\ud83d\udd39 **\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a** \u2014 \u043e\u0434\u043d\u043e \u0446\u0435\u043f\u043b\u044f\u044e\u0449\u0435\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435, \u043f\u0440\u043e\u0432\u043e\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435, \u043a\u043b\u0438\u043a\u0431\u0435\u0439\u0442\u043d\u043e\u0435, \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0449\u0435\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441, \u043d\u043e \u0431\u0435\u0437 \u0444\u0435\u0439\u043a\u0430. \u041d\u0438\u043a\u0430\u043a\u0438\u0445 \u044d\u043c\u043e\u0434\u0437\u0438 \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435.\\n\\n\ud83d\udd39 **\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435** \u2014 \u043f\u0438\u0448\u0438 \u0436\u0438\u0432\u044b\u043c, \u0440\u0430\u0437\u0433\u043e\u0432\u043e\u0440\u043d\u044b\u043c \u044f\u0437\u044b\u043a\u043e\u043c. \u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 2\u20133 \u0430\u0431\u0437\u0430\u0446\u0430 \u0438\u043b\u0438 300 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432. \u041f\u0435\u0440\u0435\u0434\u0430\u0439 \u0441\u0443\u0442\u044c \u0432\u0438\u0434\u0435\u043e, \u0443\u0441\u0438\u043b\u0438 \u0438\u043d\u0442\u0435\u0440\u0435\u0441, \u0434\u043e\u0431\u0430\u0432\u044c \u043b\u0451\u0433\u043a\u0438\u0439 \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u0438\u043b\u0438 \u0432\u043e\u043f\u0440\u043e\u0441. \u0417\u0430\u0432\u0435\u0440\u0448\u0438 \u043f\u0440\u043e\u0441\u0442\u044b\u043c \u043f\u0440\u0438\u0437\u044b\u0432\u043e\u043c \u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044e (\u0441\u043c\u043e\u0442\u0440\u0438, \u043f\u0438\u0448\u0438, \u0434\u0435\u043b\u0430\u0439).\\n\\n\u0412\u0435\u0440\u043d\u0438 \u043e\u0442\u0432\u0435\u0442 \u0441\u0442\u0440\u043e\u0433\u043e \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435:\\n\\n\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a: [\u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430]\\n\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435: [\u043a\u0440\u0430\u0442\u043a\u043e\u0435, \u0432\u043e\u0432\u043b\u0435\u043a\u0430\u044e\u0449\u0435\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435]\"\n    }\n  ]\n}\n",
        "headerParametersJson": "{\n  \"Authorization\": \"Bearer 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\",\n  \"Content-Type\": \"application/json\"\n}\n"
      },
      "name": "GPT Generate",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        -7160,
        -15860
      ],
      "id": "da30c449-6e28-45f0-8772-89578b4bf7b7"
    },
    {
      "parameters": {
        "functionCode": "const files = items; // \u043a\u0430\u0436\u0434\u044b\u0439 item \u2014 \u044d\u0442\u043e \u0444\u0430\u0439\u043b\nif (!files.length) {\n  throw new Error('\u041d\u0435\u0442 \u0444\u0430\u0439\u043b\u043e\u0432 \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u0430');\n}\n\nconst idx = Math.floor(Math.random() * files.length);\n\nreturn [\n  {\n    json: {\n      fileId: files[idx].json.id,\n      fileName: files[idx].json.name\n    }\n  }\n];\n"
      },
      "name": "Pick Random",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -6620,
        -15860
      ],
      "id": "8c7e7d17-5745-4859-a7d0-87f15812798c"
    },
    {
      "parameters": {
        "functionCode": "const content = items[0].json.choices?.[0]?.message?.content || '';\n\n// \u0418\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u043c \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a (\u043e\u0434\u043d\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u044b\u0439, \u043f\u043e\u0441\u043b\u0435 \"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a:\")\nconst titleMatch = content.match(/\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a:\\s*[\"\u201c]?(.+?)[\"\u201d]?\\n/);\n\n// \u0418\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u043c \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 (\u0432\u0441\u0451, \u0447\u0442\u043e \u043f\u043e\u0441\u043b\u0435 \"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:\")\nconst descriptionMatch = content.match(/\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:\\s*([\\s\\S]*)/);\n\n// \u0427\u0438\u0441\u0442\u0438\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\nconst title = titleMatch ? titleMatch[1].trim() : '';\nconst description = descriptionMatch ? descriptionMatch[1].trim() : '';\n\nreturn [\n  {\n    json: {\n      title,\n      description\n    }\n  }\n];\n"
      },
      "name": "Caption Source",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -6980,
        -15860
      ],
      "id": "de2affbf-a46e-4428-b67b-e2c168867984"
    },
    {
      "parameters": {
        "authentication": "airtableTokenApi",
        "operation": "list",
        "application": {
          "__rl": true,
          "value": "appvifz0ot1GllmI6",
          "mode": "id"
        },
        "table": {
          "__rl": true,
          "value": "tblOnteWFMxZZqK8m",
          "mode": "id"
        },
        "additionalOptions": {}
      },
      "name": "Check Duplicate",
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 1,
      "position": [
        -7140,
        -15620
      ],
      "id": "9593a741-71c6-4bb6-8085-d12d927bdc5a",
      "credentials": {
        "airtableTokenApi": {
          "id": "j0A9W6lTtOFzjTdr",
          "name": "Reels \u0417\u0430\u0432\u043e\u0434"
        }
      }
    },
    {
      "parameters": {
        "authentication": "airtableTokenApi",
        "operation": "append",
        "application": {
          "__rl": true,
          "value": "appvifz0ot1GllmI6",
          "mode": "id"
        },
        "table": {
          "__rl": true,
          "value": "tblOnteWFMxZZqK8m",
          "mode": "id"
        },
        "addAllFields": false,
        "options": {}
      },
      "name": "Save Record",
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 1,
      "position": [
        -6900,
        -15620
      ],
      "id": "c229eba9-b4a2-4228-8368-002deb93eb49",
      "credentials": {
        "airtableTokenApi": {
          "id": "j0A9W6lTtOFzjTdr",
          "name": "Reels \u0417\u0430\u0432\u043e\u0434"
        }
      }
    },
    {
      "parameters": {
        "requestMethod": "POST",
        "url": "https://api.autoposting.com/reels",
        "allowUnauthorizedCerts": true,
        "jsonParameters": true,
        "options": {},
        "bodyParametersJson": "{\n  \"caption\": \"{{$node['Caption Source'].json['description']}}\",\n  \"file\": \"output.mp4\"\n}"
      },
      "name": "Publish Reel",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        -6680,
        -15620
      ],
      "id": "5e820a15-2ef9-4507-aef0-eebe0b8a016d"
    },
    {
      "parameters": {
        "authentication": "airtableTokenApi",
        "operation": "update",
        "application": "airtable",
        "table": "history",
        "options": {}
      },
      "name": "Update Status",
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 1,
      "position": [
        -6480,
        -15620
      ],
      "id": "aff39bb9-5614-43d6-a2ac-c7ca4999b68c",
      "credentials": {
        "airtableTokenApi": {
          "id": "j0A9W6lTtOFzjTdr",
          "name": "Reels \u0417\u0430\u0432\u043e\u0434"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "operation": "list",
        "useQueryString": true,
        "queryString": "'1mwCMPgw6NjfEl4IiRIb1gkdFCM42gBXi' in parents and mimeType != 'application/vnd.google-apps.folder'",
        "options": {}
      },
      "name": "Get Reels",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 1,
      "position": [
        -6800,
        -15860
      ],
      "id": "66a65013-8b74-4e4d-abf9-2ac080065c90",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Vt1qBhoNFddDaUnc",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{$node[\"Pick Random\"].json[\"fileId\"]}}\n",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -6440,
        -15860
      ],
      "id": "73aec805-f8a0-48bf-8fe4-4404dcd2c472",
      "name": "Download from Drive",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Vt1qBhoNFddDaUnc",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "content": "# 1. n8n.io\n# 2. airtable.com\n# 3. developers.facebook.com\n# 4. platform.openai.com\n# 5. console.cloud.google.com\n.\n# ID -\n# Secret - \n# Access Token - EAAKp3yN0oqIBO72LfFPVfRgs6N4jWuO2Ph3GxtkBuo1O4PILEhnZBdgdRX1hxZA7ZBr9c2PQmeJkb7ZCKrkZBLgRkszNLWXTMZCzW2c52UuLXit6ZBQK2vXQ99C3H4tCNSuYAGYCpL4z1VrrgVcYtmVAfhPOF47YvZCZCkOgxmMQl9a0ivOzywiMFNKXWMX3azAQeWhxBFxYqtzcbZBQZBU7VrFhf2GJkUZBEZCp99dGrFEYjINsLLLJFxwZDZD",
        "height": 960,
        "width": 640
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -5700,
        -16680
      ],
      "typeVersion": 1,
      "id": "b2693e43-beac-4b6d-a7a8-78504180b020",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "requestMethod": "POST",
        "url": "https://api.json2video.com/v2/movies",
        "responseFormat": "file",
        "jsonParameters": true,
        "options": {},
        "bodyParametersJson": "{\n  \"comment\": \"\u0422\u0435\u0441\u0442\u043e\u0432\u043e\u0435 \u0432\u0438\u0434\u0435\u043e \u0438\u0437 n8n\",\n  \"resolution\": \"full-hd\",\n  \"draft\": true,\n  \"scenes\": [\n    {\n      \"elements\": [\n        {\n          \"type\": \"text\",\n          \"text\": \"\u041f\u0440\u0438\u0432\u0435\u0442, \u043c\u0438\u0440!\",\n          \"style\": \"005\",\n          \"duration\": 5\n        }\n      ]\n    }\n  ]\n}",
        "headerParametersJson": "{\n  \"Content-Type\": \"application/json\",\n  \"x-api-key\": \"5QWRvH54aWMKmfeHGqoj0cLpukGYFbuNeKdFsTve\"\n}"
      },
      "id": "90153d58-27d6-4af7-af40-a7ddec42b3bd",
      "name": "Create Video via json2video1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 2,
      "position": [
        -7360,
        -15620
      ]
    },
    {
      "parameters": {
        "value": "60",
        "unit": "seconds"
      },
      "name": "Wait Render",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [
        -6880,
        -17700
      ],
      "id": "fc539dc1-6abd-46fe-be57-c6b3382e80f0"
    },
    {
      "parameters": {
        "requestMethod": "GET",
        "url": "https://api.json2video.com/v2/movies/{{$node[\"Create Video via json2video\"].json[\"projectId\"]}}",
        "jsonParameters": true,
        "options": {},
        "headerParametersJson": "{\n  \"x-api-key\": \"5QWRvH54aWMKmfeHGqoj0cLpukGYFbuNeKdFsTve\"\n}"
      },
      "name": "Check Render Status",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        -6680,
        -17700
      ],
      "id": "dee177d1-69a9-4f39-af26-47579d110a16"
    },
    {
      "parameters": {
        "requestMethod": "GET",
        "url": "={{$node[\"Check Render Status\"].json[\"videoUrl\"]}}",
        "responseFormat": "file",
        "jsonParameters": true,
        "options": {}
      },
      "name": "Download Final Video",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        -6480,
        -17700
      ],
      "id": "f09030cd-0929-4291-aa08-ca1ff4c2534a"
    },
    {
      "parameters": {
        "operation": "upload",
        "binaryPropertyName": "data",
        "fileName": "output.mp4",
        "parents": "1mwCMPgw6NjfEl4IiRIb1gkdFCM42gBXi"
      },
      "name": "Upload Final Video",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -6280,
        -17700
      ],
      "id": "3f1c12a8-10bf-4e2c-9155-6bcf95432651",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Vt1qBhoNFddDaUnc",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "return [{json:{videoUrl:$node[\"Upload Final Video\"].json.webViewLink,description:$node[\"Caption Source2\"].json.description}}];"
      },
      "name": "Prepare Airtable Fields",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -6080,
        -17700
      ],
      "id": "4982569c-efd6-46bb-8b95-65d436a75a00"
    }
  ],
  "pinData": {},
  "connections": {
    "Cron": {
      "main": [
        [
          {
            "node": "GPT Generate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GPT Generate": {
      "main": [
        [
          {
            "node": "Caption Source",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pick Random": {
      "main": [
        [
          {
            "node": "Download from Drive",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Caption Source": {
      "main": [
        [
          {
            "node": "Get Reels",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Duplicate": {
      "main": [
        [
          {
            "node": "Save Record",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Record": {
      "main": [
        [
          {
            "node": "Publish Reel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Publish Reel": {
      "main": [
        [
          {
            "node": "Update Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Reels": {
      "main": [
        [
          {
            "node": "Pick Random",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download from Drive": {
      "main": [
        [
          {
            "node": "Create Video via json2video1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Video via json2video1": {
      "main": [
        [
          {
            "node": "Wait Render",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait Render": {
      "main": [
        [
          {
            "node": "Check Render Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Render Status": {
      "main": [
        [
          {
            "node": "Download Final Video",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download Final Video": {
      "main": [
        [
          {
            "node": "Upload Final Video",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload Final Video": {
      "main": [
        [
          {
            "node": "Prepare Airtable Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Airtable Fields": {
      "main": [
        [
          {
            "node": "Check Duplicate2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "b9cd2676-0653-4d7f-a7a8-bc1587d4295c",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "03802800ec9728491c300edb92e0138d87d9dcbbfccb74620634ca050fae6138"
  },
  "id": "NnoYOzymkfuqYt8O",
  "tags": []
}
